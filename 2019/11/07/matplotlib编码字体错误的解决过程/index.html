<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>matplotlib编码字体错误的解决过程 - Chireiden</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="发现问题众所周知，设置 matplotlib 输出中文需要： plt.rcParams[‘font.sans-serif’]&#x3D;[‘SimHei’]  # 用来正常显示中文标签plt.rcParams[‘axes.unicode_minus’]&#x3D;False  # 用来正常显示负号">
<meta property="og:type" content="article">
<meta property="og:title" content="matplotlib编码字体错误的解决过程">
<meta property="og:url" content="https://redcontritio.github.io/2019/11/07/matplotlib%E7%BC%96%E7%A0%81%E5%AD%97%E4%BD%93%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E8%BF%87%E7%A8%8B/index.html">
<meta property="og:site_name" content="Chireiden">
<meta property="og:description" content="发现问题众所周知，设置 matplotlib 输出中文需要： plt.rcParams[‘font.sans-serif’]&#x3D;[‘SimHei’]  # 用来正常显示中文标签plt.rcParams[‘axes.unicode_minus’]&#x3D;False  # 用来正常显示负号">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-11-07T00:11:02.000Z">
<meta property="article:modified_time" content="2023-02-12T11:00:16.966Z">
<meta property="article:author" content="RedContritio">
<meta property="article:tag" content="python matplotlib">
<meta name="twitter:card" content="summary">
    
<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/justifiedGallery/justifiedGallery.min.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">



    <!-- 这儿必须 highlight.js 不能 min，否则会换行出错 -->

    <!-- 主题可以在 https://github.com/highlightjs/highlight.js/tree/main/src/styles 里选 -->

    
        <link rel="stylesheet"
            href="//cdn.bootcss.com/highlight.js/11.0.1/styles/github-dark.min.css">
        <script src="//cdn.bootcss.com/highlight.js/11.0.1/highlight.min.js">
        </script>
        <script>
            hljs.initHighlightingOnLoad();
        </script>
    

    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1676199654491">
    
    <link rel="stylesheet" href="/css/style.css?v=1676199654491">
    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="/custom_css_source.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="chireiden-background">
        <div class="chireiden-bg" style="background-image: url(/resources/Jupiter.jpg)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon chireidenfont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="RedContritio" class="mdui-btn mdui-btn-icon"><img src="https://avatars.githubusercontent.com/u/25874478?v=4" alt="RedContritio"></a>
            </div>
        </div>
    </div>
    <div id="chireiden-header">
        <div class="chireiden-drawer mdui-drawer" id="drawer">
    <div class="chireiden-avatar mdui-ripple">
        <a href="/" title="RedContritio">
            <img src="https://avatars.githubusercontent.com/u/25874478?v=4" alt="RedContritio" alt="RedContritio">
        </a>
    </div>
    <div class="chireiden-count">
        <div><span>文章</span>15</div>
        <div><span>标签</span>9</div>
        <div><span>分类</span>0</div>
    </div>
    <div class="chireiden-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="chireiden-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon chireidenfont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="chireiden-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon chireidenfont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="chireiden-list-item mdui-list-item mdui-ripple false" href="/friend.html" title="我的朋友">
            <i class="mdui-list-item-icon chireidenfont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="chireiden-sidebar">
    
    <div class="chireiden-widget-wrap">
    <div class="chireiden-widget chireiden-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>
    
    <div class="chireiden-widget-wrap">
    <div class="chireiden-widget chireiden-social">
        <a class="mdui-ripple" href="https://jq.qq.com/?_wv=1027&k=5CfKHun" target="_blank" mdui-tooltip="{content: 'QQ群'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="chireidenfont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/20238211" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="chireidenfont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/RedContritio/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="chireidenfont icon-github"></i>
        </a>
    </div>
</div>
    
    

    
    
  <div class="chireiden-widget-wrap">
    <div id="randomtagcloud" class="chireiden-widget tagcloud chireiden-rainbow">
      <a href="/tags/Everything-%E6%B8%B8%E6%88%8F/" style="font-size: 10px;">Everything 游戏</a> <a href="/tags/VS-CSharp-Mods-Environment/" style="font-size: 10px;">VS CSharp Mods Environment</a> <a href="/tags/python-matplotlib/" style="font-size: 10px;">python matplotlib</a> <a href="/tags/ssh-sshd-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">ssh sshd 服务器 网络</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-centOS/" style="font-size: 10px;">服务器 环境配置 centOS</a> <a href="/tags/%E7%A4%BE%E5%9B%A2%E8%AF%BE%E7%A8%8B/" style="font-size: 15px;">社团课程</a> <a href="/tags/%E7%A4%BE%E5%9B%A2%E8%AF%BE%E7%A8%8B-%E9%9B%B6%E5%9F%BA%E7%A1%80%E8%AF%BE%E7%A8%8B/" style="font-size: 10px;">社团课程 零基础课程</a> <a href="/tags/%E7%BB%B4%E6%8A%A4/" style="font-size: 20px;">维护</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E9%80%9A%E8%A7%A3-%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3-%E5%B0%8F%E8%AF%B4/" style="font-size: 10px;">编程通解 编程思想 小说</a>
    </div>
    
  </div>

    
    <!-- 一言 -->

  <div class="chireiden-widget-wrap">
    <h3 class="chireiden-widget-title">
      一言
    </h3>
    <div class="chireiden-widget">
      <ul class="hitokoto-box">
        <li id="hitokoto_text_parent" class="hitokoto-text" hitokotoCategory="">
          <a href="#" id="hitokoto_text">
            
          </a>
          <a href="#" id="hitokoto_error_text" style="display: none;">
            
          </a>
        </li>
      </ul>
    </div>
  </div>

  <script>
    let hitokotoText = document.getElementById('hitokoto_text')
    let hitokotoErroText = document.getElementById('hitokoto_error_text')
    let hitokotoCategory = document.getElementById('hitokoto_text_parent').getAttribute('hitokotoCategory')
    window.onload = function () {
      let url = 'https://v1.hitokoto.cn'
      if (hitokotoCategory) {
        url += '?c=' + hitokotoCategory
      }
      fetch(url)
        .then(response => response.json())
        .then(data => {
          hitokotoText.innerText = "「 " + data.hitokoto + " 」 from " + data.from
          hitokotoText.href = 'https://hitokoto.cn/?uuid=' + data.uuid
        })
        .catch((reason) => {
          console.error(11, reason)
          hitokotoText.style.display = 'none'
          hitokotoErroText.style.display = 'block'
        })
    }
  </script>
  
    
</aside>
    <div class="chireiden-copyright">
        &copy; 2023 RedContritio
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-chireiden/hexo-theme-chireiden" target="_blank">Chireiden</a>
        <br><a target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><img src="https://i.dawnlab.me/c0268c1e6cfd0863d6ba35be1575941a.png" width="150px"></a><script data-ad-client="ca-pub-2058306854838448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </div>
</div><!-- .chireiden-drawer -->
    </div>
    <div id="chireiden-content">
        <div class="chireiden-primary">
            <div class="chireiden-post">

  <article>
      
          <div class="chireiden-post-cover" style="padding-bottom: 2em;"> 
              <!-- <img data-fancybox="gallery" src="/resources/Jupiter.jpg" alt="matplotlib编码字体错误的解决过程" loading="lazy"> -->
              <h1 class="no-gradient-h1">matplotlib编码字体错误的解决过程</h1>
          </div>
      
      
      <div class="chireiden-post-meta chireiden-rainbow" style="margin:10px 0!important;">
    <a><i class="chireidenfont icon-calendar-fill"></i>2019年11月07日</a>
</div>

      <div class="chireiden-post-meta chireiden-rainbow" style="margin:10px 0!important;">
    
        <a><i class="chireidenfont icon-areachart"></i>约2.4k字</a>
        <a><i class="chireidenfont icon-time-circle-fill"></i>预计需要12分钟</a>
    
</div>

      <h2><a href="#fa-xian-wen-ti" class="header-anchor"># </a><span id="fa-xian-wen-ti">发现问题</span></h2><p>众所周知，设置 matplotlib 输出中文需要：</p>
<p>plt.rcParams[‘font.sans-serif’]&#x3D;[‘SimHei’]  # 用来正常显示中文标签<br>plt.rcParams[‘axes.unicode_minus’]&#x3D;False  # 用来正常显示负号</p>
<span id="more"></span>

<p>第一行是设置字体（推荐使用 <code>.insert(0, fontname)</code> 而非直接赋值）</p>
<p>第二行则是设置减号（<code>-</code> ）采用 ASCII 码查找字体，而非 unicode 编码。</p>
<p>但是，在使用过程中发生了错误。</p>
<p>复现错误：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token operator">%</span>matplotlib inline

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>



plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.001</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
bins <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">**</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>data<span class="token punctuation">,</span> bins <span class="token operator">=</span> bins<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'test'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>xscale<span class="token punctuation">(</span><span class="token string">'log'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'English test'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'汉字测试'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>会发生这样的错误：</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">%pythonlib%\matplotlib\mathtext.py:849: MathTextWarning: Font &#39;default&#39; does not have a glyph for &#39;-&#39; [U+2212]
  MathTextWarning)
%pythonlib%\matplotlib\mathtext.py:850: MathTextWarning: Substituting with a dummy symbol.
  warn(&quot;Substituting with a dummy symbol.&quot;, MathTextWarning)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<p>我们可以认为是 ‘-‘ 导致的出错。</p>
<p>通过在 github 上的 <a target="_blank" rel="noopener" href="https://github.com/matplotlib/matplotlib">matplotlib 项目</a> 查找，可以找到这个文件 <a target="_blank" rel="noopener" href="https://github.com/matplotlib/matplotlib/blob/master/examples/text_labels_and_annotations/unicode_minus.py">matplotlib&#x2F;examples&#x2F;text_labels_and_annotations&#x2F;unicode_minus.py</a> ，通过看文件名，大致可知其为 <code>unicode_minus</code> 的示例文件。</p>
<p>内容如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""
=============
Unicode minus
=============
By default, tick labels at negative values are rendered using a `Unicode
minus`__ (U+2212) rather than an ASCII hyphen (U+002D).  This can be controlled
by setting :rc:`axes.unicode_minus`.
__ https://en.wikipedia.org/wiki/Plus_and_minus_signs#Character_codes
The replacement is performed at draw time of the tick labels (usually during a
`.pyplot.show()` or `.pyplot.savefig()` call). Therefore, all tick labels of
the figure follow the same setting and we cannot demonstrate both glyphs on
real tick labels of the same figure simultaneously.
Instead, this example simply showcases the difference between the two glyphs
in a magnified font.
"""</span>

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">.15</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token string">"Unicode minus:"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">.85</span><span class="token punctuation">,</span> <span class="token number">.6</span><span class="token punctuation">,</span> <span class="token string">"\N&#123;MINUS SIGN&#125;1"</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">.15</span><span class="token punctuation">,</span> <span class="token number">.3</span><span class="token punctuation">,</span> <span class="token string">"ASCII hyphen:"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">.85</span><span class="token punctuation">,</span> <span class="token number">.3</span><span class="token punctuation">,</span> <span class="token string">"-1"</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可知，<code>unicode_minus</code> 设置为 <code>False</code> 时，理应不使用 U+2212 输出，而是使用 U+002D，然而上面的错误信息却试图输出 U+2212，我们可以认为是这个选项没有起到作用。</p>
<h2><a href="#ding-wei-wen-ti" class="header-anchor"># </a><span id="ding-wei-wen-ti">定位问题</span></h2><p>通过注释，我们可以发现出现警告的原因是<code>plt.xscale(&#39;log&#39;)</code> 一行。</p>
<p>不妨在库源码中追溯来源。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>由此可知，错误是在 <code>matplotlib.pyplot.xscale</code> 调用时出现的。</p>
<p>追溯<code>matplotlib.pyplot.xscale</code> 可得：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">xscale</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    gca<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_xscale<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>首先判断 <code>gca()</code> 类型，由 <code>print(gca().__module__)</code> 输出 <code>matplotlib.axes._subplots</code> 。</p>
<p>打开对应模块，会发现找不到 <code>gca()</code> 的定义。</p>
<p>改为 <code>print(type(gca()))</code> ，输出<code>&lt;class &#39;matplotlib.axes._subplots.AxesSubplot&#39;&gt;</code> 。</p>
<p>虽然未能找到 <code>AxesSubplot</code> ，但是观察可得，<code>AxesSubplot</code> 应该是 <code>matplotlib.axes._subplots.SubplotBase</code>  的一个子类&#x2F;别名。</p>
<p>然而，在该基类中未能找到对应的函数。</p>
<p>由于 python 具有反射机制，我们想当然地去<code>matplotlib\axes\_base.py</code> 中，在<code>matplotlib.axes._base._AxesBase</code> 内，可以找到</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">set_xscale</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    g <span class="token operator">=</span> self<span class="token punctuation">.</span>get_shared_x_axes<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> ax <span class="token keyword">in</span> g<span class="token punctuation">.</span>get_siblings<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ax<span class="token punctuation">.</span>xaxis<span class="token punctuation">.</span>_set_scale<span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>_update_transScale<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>stale <span class="token operator">=</span> <span class="token boolean">True</span>

    self<span class="token punctuation">.</span>autoscale_view<span class="token punctuation">(</span>scaley<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>简单分析可知，我们出错的情况下， <code>set_xscale</code> 传入参数为 <code>set_xscale(this, &#39;log&#39;)</code> 。</p>
<p>也即通过该函数呈递给  <code>ax.xaxis._set_scale(value, **kwargs)</code> ，此时<code>value = &#39;log&#39;, kwargs=&#123;&#125;</code> 。</p>
<p>在呈递前插入</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>ax<span class="token punctuation">.</span>xaxis<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>得到输出<code>&lt;class &#39;matplotlib.axis.XAxis&#39;&gt;</code> 。</p>
<p>由于<code>XAxis</code> 继承于<code>Axis</code> ，搜索<code>_set_scale</code> 可发现其定义于后者，即基类中。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_set_scale</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>_scale <span class="token operator">=</span> mscale<span class="token punctuation">.</span>scale_factory<span class="token punctuation">(</span>value<span class="token punctuation">,</span> self<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>_scale<span class="token punctuation">.</span>set_default_locators_and_formatters<span class="token punctuation">(</span>self<span class="token punctuation">)</span>

    self<span class="token punctuation">.</span>isDefault_majloc <span class="token operator">=</span> <span class="token boolean">True</span>
    self<span class="token punctuation">.</span>isDefault_minloc <span class="token operator">=</span> <span class="token boolean">True</span>
    self<span class="token punctuation">.</span>isDefault_majfmt <span class="token operator">=</span> <span class="token boolean">True</span>
    self<span class="token punctuation">.</span>isDefault_minfmt <span class="token operator">=</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过尝试输出<code>self._scale</code> ，可以得到缩放类型为<code>&quot;log&quot;</code> 时，该变量类型为<code>matplotlib.scale.LogScale</code> 。</p>
<p>目前，我们可以得到这样的呈递关系图：</p>
<pre class="mermaid">graph TB;
    plt-->gca;
    gca-->axis;
    axis-->mscale;
    
plt[pyplot.xscale&#40'log'&#41]
gca[axes._subplots.set_xscale&#40'log'&#41]
axis[axis.XAxis._set_scale&#40'log'&#41]
mscale[scale.LogScale.set_default_locators_and_formatters&#40&#41]</pre>

<p>根据</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">LogitScale</span><span class="token punctuation">(</span>ScaleBase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">_scale_mapping <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'linear'</span><span class="token punctuation">:</span> LinearScale<span class="token punctuation">,</span>
    <span class="token string">'log'</span><span class="token punctuation">:</span>    LogScale<span class="token punctuation">,</span>
    <span class="token string">'symlog'</span><span class="token punctuation">:</span> SymmetricalLogScale<span class="token punctuation">,</span>
    <span class="token string">'logit'</span><span class="token punctuation">:</span>  LogitScale<span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">scale_factory</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> axis<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Return a scale class by name.

    ACCEPTS: [ %(names)s ]
    """</span>
    scale <span class="token operator">=</span> scale<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> scale <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        scale <span class="token operator">=</span> <span class="token string">'linear'</span>

    <span class="token keyword">if</span> scale <span class="token keyword">not</span> <span class="token keyword">in</span> _scale_mapping<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Unknown scale type '%s'"</span> <span class="token operator">%</span> scale<span class="token punctuation">)</span>

    <span class="token keyword">return</span> _scale_mapping<span class="token punctuation">[</span>scale<span class="token punctuation">]</span><span class="token punctuation">(</span>axis<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
scale_factory<span class="token punctuation">.</span>__doc__ <span class="token operator">=</span> cbook<span class="token punctuation">.</span>dedent<span class="token punctuation">(</span>scale_factory<span class="token punctuation">.</span>__doc__<span class="token punctuation">)</span> <span class="token operator">%</span> \
    <span class="token punctuation">&#123;</span><span class="token string">'names'</span><span class="token punctuation">:</span> <span class="token string">" | "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>get_scale_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可得<code>self._scale = mscale.scale_factory(&#39;log&#39;)</code> 等价于<code>self._scale = mscale.LogScale(self)</code> 。</p>
<p>到 <code>class &#39;matplotlib.scale.LogScale&#39;</code> 中可以看到方法</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">set_default_locators_and_formatters</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> axis<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Set the locators and formatters to specialized versions for
    log scaling.
    """</span>
    axis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>LogLocator<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span>
    axis<span class="token punctuation">.</span>set_major_formatter<span class="token punctuation">(</span>LogFormatterSciNotation<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span>
    axis<span class="token punctuation">.</span>set_minor_locator<span class="token punctuation">(</span>LogLocator<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base<span class="token punctuation">,</span> self<span class="token punctuation">.</span>subs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    axis<span class="token punctuation">.</span>set_minor_formatter<span class="token punctuation">(</span>
        LogFormatterSciNotation<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base<span class="token punctuation">,</span>
                                labelOnlyBase<span class="token operator">=</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>subs <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>观察易知，其分别设置刻度的标值和格式。</p>
<p>将设置四行改为</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">axis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>NullLocator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
axis<span class="token punctuation">.</span>set_major_formatter<span class="token punctuation">(</span>NullFormatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
axis<span class="token punctuation">.</span>set_minor_locator<span class="token punctuation">(</span>NullLocator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
axis<span class="token punctuation">.</span>set_minor_formatter<span class="token punctuation">(</span>NullFormatter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以发现，<code>plt.show()</code> 没有了水平刻度值，也没有警告信息。</p>
<p>通过观察可知，<code>set_major_XXX</code> 控制刻度值，而<code>set_minor_XXX</code> 控制刻度格。</p>
<p>并且错误原因在于<code>axis.set_major_formatter(LogFormatterSciNotation(self.base))</code> 。</p>
<p>因为 <code>LogScale</code> 默认以 10 为底（<code>self.base</code> ），因此可知该句等价于</p>
<p><code>Axis.set_major_formatter(LogFormatterSciNotation(10))</code></p>
<p>其中，<code>LogFormatterSciNotation</code> 类型为 <code>matplotlib.ticker.LogFormatterSciNotation</code> 。</p>
<hr>
<p>根据输出的警告信息，我们在对应位置前生成一个异常，可以得到</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> __init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> c<span class="token punctuation">,</span> state<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
   <span class="token number">1454</span>         <span class="token comment"># The real width, height and depth will be set during the</span>
   <span class="token number">1455</span>         <span class="token comment"># pack phase, after we know the real fontsize</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1456</span>         self<span class="token punctuation">.</span>_update_metrics<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">1457</span> 
   <span class="token number">1458</span>     <span class="token keyword">def</span> <span class="token function">__internal_repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _update_metrics<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
   <span class="token number">1461</span>     <span class="token keyword">def</span> <span class="token function">_update_metrics</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token number">1462</span>         metrics <span class="token operator">=</span> self<span class="token punctuation">.</span>_metrics <span class="token operator">=</span> self<span class="token punctuation">.</span>font_output<span class="token punctuation">.</span>get_metrics<span class="token punctuation">(</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1463</span>             self<span class="token punctuation">.</span>font<span class="token punctuation">,</span> self<span class="token punctuation">.</span>font_class<span class="token punctuation">,</span> self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> self<span class="token punctuation">.</span>fontsize<span class="token punctuation">,</span> self<span class="token punctuation">.</span>dpi<span class="token punctuation">,</span> self<span class="token punctuation">.</span>math<span class="token punctuation">)</span>
   <span class="token number">1464</span>         <span class="token keyword">if</span> self<span class="token punctuation">.</span>c <span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">:</span>
   <span class="token number">1465</span>             self<span class="token punctuation">.</span>width <span class="token operator">=</span> metrics<span class="token punctuation">.</span>advance

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> get_metrics<span class="token punctuation">(</span>self<span class="token punctuation">,</span> font<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">456</span>             <span class="token string">"height"</span><span class="token punctuation">.</span>
    <span class="token number">457</span>         <span class="token triple-quoted-string string">""""""</span>" <span class="token comment"># 为了不影响代码高亮，补全引号</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">458</span>         info <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_info<span class="token punctuation">(</span>font<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">459</span>         <span class="token keyword">return</span> info<span class="token punctuation">.</span>metrics
    <span class="token number">460</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_info<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">579</span> 
    <span class="token number">580</span>         font<span class="token punctuation">,</span> num<span class="token punctuation">,</span> symbol_name<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> slanted <span class="token operator">=</span> \
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">581</span>             self<span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span>fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">582</span> 
    <span class="token number">583</span>         font<span class="token punctuation">.</span>set_size<span class="token punctuation">(</span>fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">907</span>             <span class="token comment"># otherwise return regular glyph</span>
    <span class="token number">908</span>             <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span>DejaVuFonts<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>\_get_glyph<span class="token punctuation">(</span>fontname<span class="token punctuation">,</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">909</span>                     font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">910</span> 
    <span class="token number">911</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">787</span> 
    <span class="token number">788</span>     <span class="token keyword">def</span> <span class="token function">_get_glyph</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">789</span>         <span class="token keyword">raise</span> <span class="token string">"test"</span>
    <span class="token number">790</span>         found_symbol <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token number">791</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>此时的 fontname 为 ‘default’，应当改为其他内容（以满足条件 <code>fontname in (&#39;it&#39;, &#39;regular&#39;)</code> ）</p>
<hr>
<p>经测试，改 UnicodeFonts 类中 _get_glyph 内 fontname 为 ‘it’ 可解决问题。</p>
<p>经测试，改 TruetypeFonts 类中 _get_info 方法的 fontname 为 ‘it’ 也可解决问题。</p>
<p>经测试，改 Fonts 基类中的 get_metrics 方法的 font 为 ‘it’ 无效。</p>
<p>在 _get_info 添加输出，可以发现其被多处调用。</p>
<p>重新获取另一调用链，可得</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> group<span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> toks<span class="token punctuation">)</span>
   <span class="token number">2814</span> 
   <span class="token number">2815</span>     <span class="token keyword">def</span> <span class="token function">group</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> toks<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">2816</span>         grp <span class="token operator">=</span> Hlist<span class="token punctuation">(</span>toks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token number">2817</span>         <span class="token keyword">return</span> <span class="token punctuation">[</span>grp<span class="token punctuation">]</span>
   <span class="token number">2818</span>     required_group <span class="token operator">=</span> simple_group <span class="token operator">=</span> group

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> __init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> elements<span class="token punctuation">,</span> w<span class="token punctuation">,</span> m<span class="token punctuation">,</span> do_kern<span class="token punctuation">)</span>
   <span class="token number">1609</span>         List<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> elements<span class="token punctuation">)</span>
   <span class="token number">1610</span>         <span class="token keyword">if</span> do_kern<span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1611</span>             self<span class="token punctuation">.</span>kern<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">1612</span>         self<span class="token punctuation">.</span>hpack<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">1613</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> kern<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
   <span class="token number">1631</span> 
   <span class="token number">1632</span>                 new_children<span class="token punctuation">.</span>append<span class="token punctuation">(</span>elem<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1633</span>                 kerning_distance <span class="token operator">=</span> elem<span class="token punctuation">.</span>get_kerning<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">)</span>
   <span class="token number">1634</span>                 <span class="token keyword">if</span> kerning_distance <span class="token operator">!=</span> <span class="token number">0.</span><span class="token punctuation">:</span>
   <span class="token number">1635</span>                     kern <span class="token operator">=</span> Kern<span class="token punctuation">(</span>kerning_distance<span class="token punctuation">)</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> get_kerning<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">)</span>
   <span class="token number">1486</span>                 self<span class="token punctuation">.</span>font<span class="token punctuation">,</span> self<span class="token punctuation">.</span>font_class<span class="token punctuation">,</span> self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> self<span class="token punctuation">.</span>fontsize<span class="token punctuation">,</span>
   <span class="token number">1487</span>                 <span class="token builtin">next</span><span class="token punctuation">.</span>font<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">.</span>font_class<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">.</span>c<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">.</span>fontsize<span class="token punctuation">,</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1488</span>                 self<span class="token punctuation">.</span>dpi<span class="token punctuation">)</span>
   <span class="token number">1489</span>         <span class="token keyword">return</span> advance <span class="token operator">+</span> kern
   <span class="token number">1490</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> get_kern<span class="token punctuation">(</span>self<span class="token punctuation">,</span> font1<span class="token punctuation">,</span> fontclass1<span class="token punctuation">,</span> sym1<span class="token punctuation">,</span> fontsize1<span class="token punctuation">,</span> font2<span class="token punctuation">,</span> fontclass2<span class="token punctuation">,</span> sym2<span class="token punctuation">,</span> fontsize2<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
    <span class="token number">634</span>                  font2<span class="token punctuation">,</span> fontclass2<span class="token punctuation">,</span> sym2<span class="token punctuation">,</span> fontsize2<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token number">635</span>         <span class="token keyword">if</span> font1 <span class="token operator">==</span> font2 <span class="token keyword">and</span> fontsize1 <span class="token operator">==</span> fontsize2<span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">636</span>             info1 <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_info<span class="token punctuation">(</span>font1<span class="token punctuation">,</span> fontclass1<span class="token punctuation">,</span> sym1<span class="token punctuation">,</span> fontsize1<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
    <span class="token number">637</span>             info2 <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_info<span class="token punctuation">(</span>font2<span class="token punctuation">,</span> fontclass2<span class="token punctuation">,</span> sym2<span class="token punctuation">,</span> fontsize2<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
    <span class="token number">638</span>             font <span class="token operator">=</span> info1<span class="token punctuation">.</span>font

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_info<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">580</span> 
    <span class="token number">581</span>         font<span class="token punctuation">,</span> num<span class="token punctuation">,</span> symbol_name<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> slanted <span class="token operator">=</span> \
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">582</span>             self<span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span>fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">583</span> 
    <span class="token number">584</span>         font<span class="token punctuation">.</span>set_size<span class="token punctuation">(</span>fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">909</span>             <span class="token comment"># otherwise return regular glyph</span>
    <span class="token number">910</span>             <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span>DejaVuFonts<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span>fontname<span class="token punctuation">,</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">911</span>                     font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">912</span> 
    <span class="token number">913</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">840</span>                 <span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token number">841</span>                     <span class="token keyword">return</span> self<span class="token punctuation">.</span>cm_fallback<span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">842</span>                         fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">)</span>
    <span class="token number">843</span>             <span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token number">844</span>                 <span class="token keyword">if</span> fontname <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'it'</span><span class="token punctuation">,</span> <span class="token string">'regular'</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> StixFonts<span class="token punctuation">)</span><span class="token punctuation">:</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">845</span>                     <span class="token keyword">return</span> self<span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span><span class="token string">'rm'</span><span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">)</span>
    <span class="token number">846</span>                 <span class="token keyword">print</span><span class="token punctuation">(</span>fontname<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">847</span>                 <span class="token keyword">raise</span> <span class="token string">'error'</span>
    <span class="token number">848</span>                 warn<span class="token punctuation">(</span><span class="token string">"Font '%s' does not have a glyph for '%s' [U+%x]"</span> <span class="token operator">%</span>
    <span class="token number">849</span>                      <span class="token punctuation">(</span>new_fontname<span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>为了方便此后调试，在改动部分加上 <code># RecoDebugging</code> 。</p>
<p>该次 Bug 出错在于 <code>mathtext.Char.font = &#39;default&#39;</code> ，经过捕捉可发现其被 <code>state.font</code> 赋值，即 <code>matplotlib.mathtext.Parser.State.font</code> 。</p>
<p>追踪这个构造函数调用，可得</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> symbol<span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> toks<span class="token punctuation">)</span>
   <span class="token number">2638</span>         c <span class="token operator">=</span> toks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
   <span class="token number">2639</span>         <span class="token keyword">try</span><span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">2640</span>             char <span class="token operator">=</span> Char<span class="token punctuation">(</span>c<span class="token punctuation">,</span> self<span class="token punctuation">.</span>get_state<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token number">2641</span>         <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
   <span class="token number">2642</span>             <span class="token keyword">raise</span> ParseFatalException<span class="token punctuation">(</span>s<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> <span class="token string">"Unknown symbol: %s"</span> <span class="token operator">%</span> c<span class="token punctuation">)</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> __init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> c<span class="token punctuation">,</span> state<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
   <span class="token number">1449</span>         self<span class="token punctuation">.</span>c <span class="token operator">=</span> c
   <span class="token number">1450</span>         self<span class="token punctuation">.</span>font_output <span class="token operator">=</span> state<span class="token punctuation">.</span>font_output
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1451</span>         <span class="token keyword">raise</span> <span class="token string">'test'</span>
   <span class="token number">1452</span>         self<span class="token punctuation">.</span>font <span class="token operator">=</span> state<span class="token punctuation">.</span>font
   <span class="token number">1453</span>         self<span class="token punctuation">.</span>font_class <span class="token operator">=</span> state<span class="token punctuation">.</span>font_class<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>观察 <code>matplotlib.mathtext.Parser.symbol</code> 可得，<code>Parser.State</code> 构造函数被调用于 </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> parse<span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">,</span> fonts_object<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
   <span class="token number">2513</span>         Returns the parse tree of <span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">:</span>`Node` instances<span class="token punctuation">.</span>
   <span class="token number">2514</span>         <span class="token triple-quoted-string string">""""""</span> <span class="token comment"># end the comment</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">2515</span>         self<span class="token punctuation">.</span>_state_stack <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>State<span class="token punctuation">(</span>fonts_object<span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token string">'rm'</span><span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span><span class="token punctuation">]</span>
   <span class="token number">2516</span>         self<span class="token punctuation">.</span>_em_width_cache <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
   <span class="token number">2517</span>         <span class="token keyword">try</span><span class="token punctuation">:</span>

C<span class="token punctuation">:</span>\ProgramData\Anaconda3\lib\site<span class="token operator">-</span>packages\matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> __init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> font_output<span class="token punctuation">,</span> font<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
   <span class="token number">2540</span>         <span class="token triple-quoted-string string">""""""</span>  <span class="token comment"># end the comment</span>
   <span class="token number">2541</span>         <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> font_output<span class="token punctuation">,</span> font<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">2542</span>             <span class="token keyword">raise</span> <span class="token string">'generate state'</span>
   <span class="token number">2543</span>             self<span class="token punctuation">.</span>font_output <span class="token operator">=</span> font_output
   <span class="token number">2544</span>             self<span class="token punctuation">.</span>_font <span class="token operator">=</span> font<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>最终可以发现，<code>state</code> 被赋值于此处，只需要修改 <code>matplotlib.mathtext.Parser.parse</code> 即可结束此支错误。</p>
<hr>
<p>暂改为 ‘it’，运行仍然出错，主动抛出异常，捕获链如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> group<span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> toks<span class="token punctuation">)</span>
   <span class="token number">2815</span> 
   <span class="token number">2816</span>     <span class="token keyword">def</span> <span class="token function">group</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> toks<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">2817</span>         grp <span class="token operator">=</span> Hlist<span class="token punctuation">(</span>toks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token number">2818</span>         <span class="token keyword">return</span> <span class="token punctuation">[</span>grp<span class="token punctuation">]</span>
   <span class="token number">2819</span>     required_group <span class="token operator">=</span> simple_group <span class="token operator">=</span> group

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> __init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> elements<span class="token punctuation">,</span> w<span class="token punctuation">,</span> m<span class="token punctuation">,</span> do_kern<span class="token punctuation">)</span>
   <span class="token number">1609</span>         List<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> elements<span class="token punctuation">)</span>
   <span class="token number">1610</span>         <span class="token keyword">if</span> do_kern<span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1611</span>             self<span class="token punctuation">.</span>kern<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">1612</span>         self<span class="token punctuation">.</span>hpack<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token number">1613</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> kern<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
   <span class="token number">1631</span> 
   <span class="token number">1632</span>                 new_children<span class="token punctuation">.</span>append<span class="token punctuation">(</span>elem<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1633</span>                 kerning_distance <span class="token operator">=</span> elem<span class="token punctuation">.</span>get_kerning<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">)</span>
   <span class="token number">1634</span>                 <span class="token keyword">if</span> kerning_distance <span class="token operator">!=</span> <span class="token number">0.</span><span class="token punctuation">:</span>
   <span class="token number">1635</span>                     kern <span class="token operator">=</span> Kern<span class="token punctuation">(</span>kerning_distance<span class="token punctuation">)</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> get_kerning<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">)</span>
   <span class="token number">1486</span>                 self<span class="token punctuation">.</span>font<span class="token punctuation">,</span> self<span class="token punctuation">.</span>font_class<span class="token punctuation">,</span> self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> self<span class="token punctuation">.</span>fontsize<span class="token punctuation">,</span>
   <span class="token number">1487</span>                 <span class="token builtin">next</span><span class="token punctuation">.</span>font<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">.</span>font_class<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">.</span>c<span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">.</span>fontsize<span class="token punctuation">,</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token number">1488</span>                 self<span class="token punctuation">.</span>dpi<span class="token punctuation">)</span>
   <span class="token number">1489</span>         <span class="token keyword">return</span> advance <span class="token operator">+</span> kern
   <span class="token number">1490</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> get_kern<span class="token punctuation">(</span>self<span class="token punctuation">,</span> font1<span class="token punctuation">,</span> fontclass1<span class="token punctuation">,</span> sym1<span class="token punctuation">,</span> fontsize1<span class="token punctuation">,</span> font2<span class="token punctuation">,</span> fontclass2<span class="token punctuation">,</span> sym2<span class="token punctuation">,</span> fontsize2<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
    <span class="token number">634</span>                  font2<span class="token punctuation">,</span> fontclass2<span class="token punctuation">,</span> sym2<span class="token punctuation">,</span> fontsize2<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token number">635</span>         <span class="token keyword">if</span> font1 <span class="token operator">==</span> font2 <span class="token keyword">and</span> fontsize1 <span class="token operator">==</span> fontsize2<span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">636</span>             info1 <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_info<span class="token punctuation">(</span>font1<span class="token punctuation">,</span> fontclass1<span class="token punctuation">,</span> sym1<span class="token punctuation">,</span> fontsize1<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
    <span class="token number">637</span>             info2 <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_info<span class="token punctuation">(</span>font2<span class="token punctuation">,</span> fontclass2<span class="token punctuation">,</span> sym2<span class="token punctuation">,</span> fontsize2<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>
    <span class="token number">638</span>             font <span class="token operator">=</span> info1<span class="token punctuation">.</span>font

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_info<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">580</span> 
    <span class="token number">581</span>         font<span class="token punctuation">,</span> num<span class="token punctuation">,</span> symbol_name<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> slanted <span class="token operator">=</span> \
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">582</span>             self<span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span>fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">583</span> 
    <span class="token number">584</span>         font<span class="token punctuation">.</span>set_size<span class="token punctuation">(</span>fontsize<span class="token punctuation">,</span> dpi<span class="token punctuation">)</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">909</span>             <span class="token comment"># otherwise return regular glyph</span>
    <span class="token number">910</span>             <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span>DejaVuFonts<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span>fontname<span class="token punctuation">,</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">911</span>                     font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">912</span> 
    <span class="token number">913</span> 

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">840</span>                 <span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token number">841</span>                     <span class="token keyword">return</span> self<span class="token punctuation">.</span>cm_fallback<span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">842</span>                         fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">)</span>
    <span class="token number">843</span>             <span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token number">844</span>                 <span class="token keyword">if</span> fontname <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'it'</span><span class="token punctuation">,</span> <span class="token string">'regular'</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> StixFonts<span class="token punctuation">)</span><span class="token punctuation">:</span>

matplotlib\mathtext<span class="token punctuation">.</span>py <span class="token keyword">in</span> _get_glyph<span class="token punctuation">(</span>self<span class="token punctuation">,</span> fontname<span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">,</span> math<span class="token punctuation">)</span>
    <span class="token number">845</span>                     <span class="token keyword">return</span> self<span class="token punctuation">.</span>_get_glyph<span class="token punctuation">(</span><span class="token string">'rm'</span><span class="token punctuation">,</span> font_class<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> fontsize<span class="token punctuation">)</span>
    <span class="token number">846</span>                 <span class="token comment">#print(fontname)</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">847</span>                 <span class="token keyword">raise</span> <span class="token string">'error'</span> <span class="token comment"># RecoDebugging</span>
    <span class="token number">848</span>                 warn<span class="token punctuation">(</span><span class="token string">"Font '%s' does not have a glyph for '%s' [U+%x]"</span> <span class="token operator">%</span>
    <span class="token number">849</span>                      <span class="token punctuation">(</span>new_fontname<span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


  </article>

  
      
    <div class="chireiden-post-copyright">
        <strong>本文作者：</strong>RedContritio<br>
        <strong>本文链接：</strong><a href="https://redcontritio.github.io/2019/11/07/matplotlib%E7%BC%96%E7%A0%81%E5%AD%97%E4%BD%93%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E8%BF%87%E7%A8%8B/" title="https:&#x2F;&#x2F;redcontritio.github.io&#x2F;2019&#x2F;11&#x2F;07&#x2F;matplotlib%E7%BC%96%E7%A0%81%E5%AD%97%E4%BD%93%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E8%BF%87%E7%A8%8B&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;redcontritio.github.io&#x2F;2019&#x2F;11&#x2F;07&#x2F;matplotlib%E7%BC%96%E7%A0%81%E5%AD%97%E4%BD%93%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E8%BF%87%E7%A8%8B&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="chireiden-post-meta chireiden-rainbow">
    
    
        <a class="chireidenfont icon-tag-fill -none-link" href="/tags/python-matplotlib/" rel="tag">python matplotlib</a>
    
</div>

  
      <div class="chireiden-post-footer">
          <section class="chireiden-comment">
    <div id="gitment"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
    owner: 'RedContritio', // 你的 GitHub ID
    repo: 'RedContritio.github.io', // 存储评论的 repo
    oauth: {
        client_id: '0a6a884a25f2cfcd11b3', // 你的 client ID
        client_secret: '&lt;CLIENT_COMMENT_SECRET&gt;' // 你的 client secret
    },
})
gitment.render('gitment')
</script>
</section>
      </div>
  
</div>
            <div class="chireiden-post-right">
              <div class="chireiden-fixed">
                  <div class="chireiden-tool"> 
                    
                      
                    
                      <a href="#chireiden-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="chireidenfont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="chireiden-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="搜索" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    
<script src="/lib/mdui_043tiny/mdui.js"></script>
<script src="/lib/jquery.min.js"></script>
<script src="/lib/justifiedGallery/jquery.justifiedGallery.min.js"></script>
<script src="/lib/fancybox/fancybox.umd.js"></script>


 

<script async src="/js/app.js?v=1676199654492"></script>



<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





</body>

</html>
