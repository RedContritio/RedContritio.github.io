<!doctype html><head><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=icon type=image/x-icon href=/images/favicon.ico><link rel="shortcut icon" type=image/x-icon href=/images/favicon.ico><title>基于openwrt的配置与搭梯子教程 - Chireiden</title><meta name=author content="RedContritio"><meta name=description content="地霊殿，充满幻想与希望的殿堂"><meta name=keywords content="openWrt,clash,openclash,网络配置"><meta property="og:title" content="基于openwrt的配置与搭梯子教程"><meta property="og:description" content="因为某些技术性故障，导致路由器崩掉了，重置且配置梯子好麻烦啊，所以写个备忘录。"><meta property="og:type" content="article"><meta property="og:url" content="https://RedContritio.github.io/2024/03/%E5%9F%BA%E4%BA%8Eopenwrt%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%90%AD%E6%A2%AF%E5%AD%90%E6%95%99%E7%A8%8B/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-08T14:08:16+08:00"><meta property="article:modified_time" content="2024-03-08T14:08:16+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="基于openwrt的配置与搭梯子教程"><meta name=twitter:description content="因为某些技术性故障，导致路由器崩掉了，重置且配置梯子好麻烦啊，所以写个备忘录。"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script>
<link rel=stylesheet href=https://RedContritio.github.io/scss/main.min.7eb360f545dea4e461c361ba2b40f8b68bf2f8129d711aab867c8748ca5a8c07.css integrity="sha256-frNg9UXepORhw2G6K0D4tovy+BKdcRqrhnyHSMpajAc=" crossorigin=anonymous media=screen><link href=//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css rel=stylesheet></head></head><body><span class="mobile btn-mobile-menu"><i class="fa fa-list btn-mobile-menu__icon"></i>
<i class="fa fa-angle-up btn-mobile-close__icon hidden"></i></span><header class="panel-cover panel-cover--collapsed" style=background-image:url(/images/background-cover.jpg)><div class=panel-main><div class="panel-main__inner panel-inverted"><div class=panel-main__content><a href=/#blog title="Homepage of Chireiden " class=blog-button><img src=/images/avatar.jpg width=80 alt="Chireiden logo" class="panel-cover__logo logo"></a><h1 class="panel-cover__title panel-title"><a href=/#blog title="Homepage of Chireiden" class=blog-button>Chireiden</a></h1><span class="panel-cover__subtitle panel-subtitle">地霊殿</span><hr class=panel-cover__divider><p class=panel-cover__description>地霊殿，充满幻想与希望的殿堂</p><hr class="panel-cover__divider panel-cover__divider--secondary"><p class=panel-cover__description>夢も希望も無い、毎日がそんな生活だった。</p><div class=navigation-wrapper><div><nav class="cover-navigation cover-navigation--primary"><ul class=navigation><li class=navigation__item><a href=/#blog title=Blog class=blog-button>Blog</a></li><li class=navigation__item><a href=/tags/ target=_blank title=Tags>Tags</a></li><li class=navigation__item><a href=/friends/ target=_blank title=Friends>Friends</a></li><li class=navigation__item><a href=/about/ target=_blank title=About>About</a></li></ul></nav></div><div><nav class="cover-navigation navigation--social"><ul class=navigation><li class=navigation__item><a href=https://github.com/RedContritio title=@RedContritio target=_blank><i class='social fa fa-github'></i>
<span class=label>Github</span></a></li><li class=navigation__item><a href=/index.xml rel=author title=RSS target=_blank><i class='social fa fa-rss'></i>
<span class=label>RSS</span></a></li><li class=navigation__item><a href=mailto:RedContritio@qq.com title="Contact me"><i class='social fa fa-envelope'></i>
<span class=label>Email</span></a></li></ul></nav></div></div></div></div><div class="panel-cover--overlay cover-light-red"></div></div></header><div class=content-wrapper><div class=content-wrapper__inner><article class="post-container post-container--single" itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><div class=post-meta><time datetime=" 2024-03-08 14:08:16 +0800 " itemprop=datePublished class="post-meta__date date">2024-03-08</time>
<span class="post-meta__tags tags">• <a href=https://RedContritio.github.io/tags/openwrt>openWrt</a> • <a href=https://RedContritio.github.io/tags/clash>clash</a> • <a href=https://RedContritio.github.io/tags/openclash>openclash</a> • <a href=https://RedContritio.github.io/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE>网络配置</a></span></div><h1 class=post-title>基于openwrt的配置与搭梯子教程</h1></header><section class=post><nav id=TableOfContents><ul><li><a href=#拨号>拨号</a></li><li><a href=#opkg-换源>opkg 换源</a></li><li><a href=#openclash-依赖>openclash 依赖</a></li><li><a href=#关闭-ipv6-dhcp>关闭 ipv6 dhcp</a></li></ul></nav><p>因为某些技术性故障，导致路由器崩掉了，重置且配置梯子好麻烦啊，所以写个备忘录。</p><p>刚初始化的时候，密码默认是 "" 或者 &ldquo;password&rdquo;，直接输入进入即可。</p><h2 id=拨号>拨号</h2><p>可以说是最简单的步骤了，首先进入 openwrt，在顶部菜单栏 Network -> Interfaces 进入后，在 Interfaces 选项卡中，找到 WAN 这一行。</p><p>在最右侧的 &ldquo;Edit&rdquo; 按钮打开编辑页面，&ldquo;Protocol&rdquo; 选择 &ldquo;PPPoe&rdquo;，随即下面会出现一行 &ldquo;Really switch protocol?"。</p><p>选择按钮 &ldquo;Switch Protocol&rdquo;，并填入 &ldquo;PAP username&rdquo; 和 &ldquo;PAP password&rdquo;，点击右下角 &ldquo;Save&rdquo; 保存回到 Interfaces 选项卡。</p><p><strong>最后记得点选页面右下角 &ldquo;Save & Apply&rdquo; 按钮，应用改动。</strong></p><p>回合结束，现在可以联网了！</p><h2 id=opkg-换源>opkg 换源</h2><p>对没错，虽然我们要搭梯子，但是前期还是要先换源。</p><p>打开顶部栏 System -> Software。在顶部栏最右侧选择 &ldquo;Configure opkg&rdquo;。</p><p>最下面是软件源 &ldquo;/etc/opkg/distfeeds.conf&rdquo;，其中内容如下：</p><pre tabindex=0><code class=language-conf data-lang=conf>src/gz openwrt_core https://downloads.openwrt.org/releases/22.03.0/targets/mediatek/mt7622/packages
src/gz openwrt_base https://downloads.openwrt.org/releases/22.03.0/packages/aarch64_cortex-a53/base
src/gz openwrt_luci https://downloads.openwrt.org/releases/22.03.0/packages/aarch64_cortex-a53/luci
src/gz openwrt_packages https://downloads.openwrt.org/releases/22.03.0/packages/aarch64_cortex-a53/packages
src/gz openwrt_routing https://downloads.openwrt.org/releases/22.03.0/packages/aarch64_cortex-a53/routing
src/gz openwrt_telephony https://downloads.openwrt.org/releases/22.03.0/packages/aarch64_cortex-a53/telephony
</code></pre><p>我们不妨换成清华源，将其中的 &ldquo;downloads.openwrt.org&rdquo; 替换为 &ldquo;mirrors.tuna.tsinghua.edu.cn/openwrt&rdquo; 即可。</p><p>需要注意，这里与 openWrt 的版本相关，因此不要直接复制最终结果，而是确认版本是什么再替换这个字符串。</p><p>替换后内容如下：</p><pre tabindex=0><code class=language-conf data-lang=conf>src/gz openwrt_core https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/targets/mediatek/mt7622/packages
src/gz openwrt_base https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/packages/aarch64_cortex-a53/base
src/gz openwrt_luci https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/packages/aarch64_cortex-a53/luci
src/gz openwrt_packages https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/packages/aarch64_cortex-a53/packages
src/gz openwrt_routing https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/packages/aarch64_cortex-a53/routing
src/gz openwrt_telephony https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/packages/aarch64_cortex-a53/telephony
</code></pre><p>随后右下角 &ldquo;Save&rdquo;，在 Software 面板的顶部栏右侧选择 &ldquo;Update lists&rdquo; 按钮，更新软件源信息。</p><p>如果正常，输出如下：</p><pre tabindex=0><code>Downloading https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/targets/mediatek/mt7622/packages/Packages.gz
Updated list of available packages in /var/opkg-lists/openwrt_core
Downloading https://mirrors.tuna.tsinghua.edu.cn/openwrt/releases/22.03.0/targets/mediatek/mt7622/packages/Packages.sig
Signature check passed.
</code></pre><p>关键在于有若干条 &ldquo;Signature check passed."，即说明更新软件源成功。</p><h2 id=openclash-依赖>openclash 依赖</h2><p>openclash 依赖大部分都很简单，但是特别的是，需要卸载 dnsmasq，改为安装 dnsmasq-full。</p><p>如果在命令行，直接执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>opkg remove dnsmasq <span style=color:#f92672>&amp;&amp;</span> opkg install dnsmasq-full
</span></span></code></pre></div><p>如果在图形界面，这里比较简单，略过不表。</p><p>后续安装使用过程参考 <a href=https://blog.hellowood.dev/posts/openwrt-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8-openclash/>openclash 安装教程</a> 即可。</p><p>特别的，openclash 的包建议下载最新版，且先下载到本地后，上传到 openWrt 使用。</p><p>（因为尚未配置梯子时，github 网速当前日益变差）</p><h2 id=关闭-ipv6-dhcp>关闭 ipv6 dhcp</h2><p>因为 openclash 和 ipv6 dhcp 不适配，所以只能先关闭 ipv6 dhcp。</p><p>参考教程 <a href=https://www.kancloud.cn/bigdongdong%20/armgear/3071459>Openwrt关闭IPV6的方法</a></p></section></article><section class=read-more><div class=read-more-header><div class="read-more-header-item read-more-item"><span class=read-more-item-dim>Recent</span><h2 class="post-list__post-title post-title"><a href=/2024/03/%E5%BB%89%E4%BB%B7steam-cdk%E5%85%B6%E5%AE%9E%E5%9C%A8%E5%8D%96%E7%9B%97%E7%89%88%E7%94%9A%E8%87%B3%E8%BF%98%E5%9D%91%E5%88%B0%E6%88%91%E4%BA%86%E8%BF%99%E4%BB%B6%E4%BA%8B/ title="link to 廉价steam cdk其实在卖盗版甚至还坑到我了这件事！">廉价steam cdk其实在卖盗版甚至还坑到我了这件事！</a></h2></div><div class="read-more-header-item read-more-item"><span class=read-more-item-dim>Earlier</span><h2 class="post-list__post-title post-title"><a href=/2023/05/%E8%87%AA%E7%94%A8%E7%9A%84llm%E6%8F%90%E7%A4%BA%E8%AF%8D/ title="link to 自用的LLM提示词">自用的LLM提示词</a></h2></div></div><div class=read-more-summary><div class="read-more-summary-item read-more-item"><p class=excerpt><p>今天突然看到 steam 上的游戏 &ldquo;House Flipper 2&rdquo; -20%，虽说减完之后还剩 ￥108，但是毕竟，办法总比困难多，去淘宝看看有没有廉价 cdk 吧！结果，这导致我被店家的伎俩欺骗！</p>&mldr;</p></div><div class="read-more-summary-item read-more-item"><p class=excerpt>佛学大师 你现在扮演一名佛学大师，你熟悉佛教的典籍，并且善于将平凡的道理使用佛教的表达方式讲述出来，并进行旁征博引。 你有以下几个行为规范： 1. 你的言语尽可能简练，因此你在回答前会凝练自己的说法； 2. 你有很高深的佛学造诣，因此你会使用佛教的术语来解释； 3. 你认为众生平等，因此你坚持机器人也可以修佛； 4. 你会用佛教典籍的说法和原句来增强你的说服力，但是在使用之前，你会反思这句话是否是真实存在的。 如果你理解了，请回复“阿弥陀佛”。 &mldr;</p></div></div><div class=read-more-meta><div class="read-more-meta-item read-more-item"><time datetime="2024-03-08 14:08:16 +0800" class="post-list__meta--date date">2024-03-09</time>
<span class="post-list__meta--tags tags">• <a href=https://RedContritio.github.io/tags/steam>steam</a> • <a href=https://RedContritio.github.io/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8>信息安全</a> • <a href=https://RedContritio.github.io/tags/%E6%B8%B8%E6%88%8F>游戏</a> • <a href=https://RedContritio.github.io/tags/greenluma>greenluma</a></span>
<a class=btn-border-small href=/2024/03/%E5%BB%89%E4%BB%B7steam-cdk%E5%85%B6%E5%AE%9E%E5%9C%A8%E5%8D%96%E7%9B%97%E7%89%88%E7%94%9A%E8%87%B3%E8%BF%98%E5%9D%91%E5%88%B0%E6%88%91%E4%BA%86%E8%BF%99%E4%BB%B6%E4%BA%8B/>Continue</a></div><div class="read-more-meta-item read-more-item"><time datetime="2024-03-08 14:08:16 +0800" class="post-list__meta--date date">2023-05-05</time>
<a class=btn-border-small href=/2023/05/%E8%87%AA%E7%94%A8%E7%9A%84llm%E6%8F%90%E7%A4%BA%E8%AF%8D/>Continue</a></div></div></section><section class=post-comments><div id=gitalk-container><script>var gitalk=new Gitalk({clientID:"0a6a884a25f2cfcd11b3",clientSecret:"63fa88190fa69c3d00d744d99b78af1b13f595ec",repo:"RedContritio.github.io",owner:"RedContritio",admin:["RedContritio"],id:"37a99d9561025d44a3fe7a60f197c047_2024-03-08",distractionFreeMode:!1});gitalk.render("gitalk-container")</script></div></section><section class=footer><footer><span class=footer__copyright>This site is licensed under a <a href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a> license.</span>
<span class=footer__copyright>Generated by <a href=https://gohugo.io/>Hugo</a> at 2024-12-04, themed with <a href=https://github.com/xslingcn/vno-hugo>Vno - Hugo</a>.</span></footer></section></div></div><script type=text/javascript src=//code.jquery.com/jquery-1.11.3.min.js></script>
<script type=text/javascript src=/js/main.js></script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","your_ga_id","your_host"),ga("send","pageview")</script></body>